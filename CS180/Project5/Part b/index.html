<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Project 5b: Diffusion Models from Scratch!</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            margin: 0;
            padding: 0;
        }
        header, h1, h2, h3 {
            text-align: center;
            margin: 20px 0;
        }
        header {
            background-color: #e67e22;
            color: white;
            padding: 40px 0;
            margin-bottom: 40px;
        }
        h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }
        h2 {
            color: #e67e22;
            margin-top: 60px;
            margin-bottom: 20px;
        }
        h3 {
            color: #333;
            margin-top: 40px;
            margin-bottom: 15px;
        }
        p {
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto 20px auto;
            padding: 0 20px;
        }
        img {
            display: block;
            max-width: 100%;
            height: auto;
            margin: 20px auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .image-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }
        .image-row img {
            width: 45%;
            margin: 10px;
        }
        footer {
            text-align: center;
            padding: 20px 0;
            background-color: #e67e22;
            color: white;
            margin-top: 60px;
        }
        @media (max-width: 768px) {
            h1 {
                font-size: 28px;
            }
            .image-row img {
                width: 90%;
            }
        }
    </style>
</head>
<body>

<header>
    <h1>Project 5b: Diffusion Models from Scratch!</h1>
    <p>Implementing and training diffusion models step by step</p>
</header>

<h2>Part 1: Training a Single-Step Denoising UNet</h2>

<p>Following the method introduced in the paper, I implemented a single-step denoising UNet. I trained the UNet on the MNIST dataset. The training loss curve is shown below:</p>

<!-- Insert image -->
<img src="training_loss_curve.png" alt="Training Loss Curve">

<p>The visualization of the different noising processes over α = 0.0, 0.2, 0.4, 0.6, 0.8, 1.0:</p>

<!-- Insert image -->
<img src="noising_process_visualization.png" alt="Noising Process Visualization">

<p>Then I visualized denoised results on the test set at the end of training. Displaying sample results after the 1st and 5th epoch. The results are shown below:</p>

<!-- Insert images -->
<div class="image-row">
    <img src="denoised_results_epoch1.png" alt="Denoised Results After 1st Epoch">
    <img src="denoised_results_epoch5.png" alt="Denoised Results After 5th Epoch">
</div>

<p>Visualization of the denoiser results on test set digits with varying levels of noise over α = 0.0, 0.2, 0.4, 0.6, 0.8, 1.0. The result is shown below:</p>

<!-- Insert image -->
<img src="denoiser_results_varying_alpha.png" alt="Denoiser Results with Varying Alpha">

<h2>Part 2: Training a Diffusion Model</h2>

<h3>2.1 Adding Time Conditioning to UNet</h3>

<p>Time conditioning involves encoding the timestep <em>t</em> into a latent representation and injecting it into the UNet to inform the model about the stage of the denoising process, as introduced in the paper.</p>

<h3>2.2 Training the Time-Conditioned UNet</h3>

<p>I trained the time-conditioned UNet on the MNIST dataset. The training loss curve is shown below:</p>

<!-- Insert image -->
<img src="time_conditioned_training_loss.png" alt="Time-Conditioned Training Loss Curve">

<h3>2.3 Sampling from the Model</h3>

<p>Sampling from the model trained above. I sampled after 5 epochs and 20 epochs:</p>

<!-- Insert images -->
<div class="image-row">
    <img src="samples_after_epoch5.png" alt="Samples After 5 Epochs">
    <img src="samples_after_epoch20.png" alt="Samples After 20 Epochs">
</div>

<h3>2.4 Class Conditioning</h3>

<p>Class conditioning allows the UNet to generate images conditioned on a specific class (e.g., digits 0–9 for MNIST). This is achieved by injecting a one-hot encoded class vector into the network. The training loss curve is shown below:</p>

<!-- Insert image -->
<img src="class_conditioning_training_loss.png" alt="Class Conditioning Training Loss Curve">

<h3>2.5 Sampling from the Class-Conditioned Model</h3>

<p>Sampling from the class-conditioned model trained above. I also sampled after 5 epochs and 20 epochs:</p>

<!-- Insert images -->
<div class="image-row">
    <img src="class_conditioned_samples_epoch5.png" alt="Class-Conditioned Samples After 5 Epochs">
    <img src="class_conditioned_samples_epoch20.png" alt="Class-Conditioned Samples After 20 Epochs">
</div>

<footer>
    <p>&copy; 2023 Diffusion Models from Scratch</p>
</footer>

</body>
</html>

